---
import { Icon } from "astro-icon/components";
import { NavBarLink } from "../../types/config";
import { siteConfig } from "../../config";
import Search from "./Search.svelte";
import { url } from "../../utils/url-utils";
import ThemeSwitch from "./ThemeSwitch/ThemeSwitch";
import {
	arrowIcon,
	button,
	card,
	homeIcon,
	homeLink,
	linksWrapper,
	navLink,
	searchIcon,
	searchWrapper
} from "./Navbar.css";
import NavMenu from "./NavMenu/NavMenu";

const links: NavBarLink[] = [
	{ name: "Archive", url: "/archive" },
	{ name: "About", url: "/about" }
];
---
<div class={card}>
	<a href={url("/")} class={button}>
		<div class={homeLink}>
			<Icon name="material-symbols:home-outline-rounded" size={"1.75rem"} class={homeIcon} />
			{siteConfig.title}
		</div>
	</a>

	<div class={linksWrapper}>
		{links.map(({ name, url }) =>
			<a aria-label={name} href={url} class={navLink}>
				<div class="flex items-center">
					{name}
				</div>
			</a>
		)}
	</div>

	<div class={searchWrapper}>
		<Search client:load>
			<Icon slot="search-icon" name="material-symbols:search" size={"1.25rem"} class={searchIcon} />
			<Icon slot="arrow-icon" name="fa6-solid:chevron-right" size={"0.75rem"} class={arrowIcon} />
			<Icon slot="search-switch" name="material-symbols:search" size={"1.25rem"}></Icon>
		</Search>

		<ThemeSwitch client:only="react"></ThemeSwitch>

		<NavMenu client:load links={links} />
	</div>
</div>

<script is:inline define:vars={{ scriptUrl: url("/pagefind/pagefind.js") }}>
	async function loadPagefind() {
		const pagefind = await import(scriptUrl);
		await pagefind.options({
			"excerptLength": 20
		});
		pagefind.init();
		window.pagefind = pagefind;
		pagefind.search("");     // speed up the first search
	}

	loadPagefind();
</script>