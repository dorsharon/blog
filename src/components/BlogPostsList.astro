---
import { getCollection } from "astro:content";
import { Image } from "astro:assets";
import FormattedDate from "./FormattedDate.astro";

const { BASE_URL } = import.meta.env;

const posts = (await getCollection("blog")).sort(
	(a, b) => a.data.publishDate.valueOf() - b.data.publishDate.valueOf(),
);
---

<section>
	{
		posts.map(({ slug, data }) => (
			<a href={`${BASE_URL}/posts/${slug}/`}>
				<Image
					src={data.image}
					alt={data.title}
					format="avif"
					width={400}
				/>

				<div class="post-info">
					<h4 class="title">{data.title}</h4>
					<h5 class="title">{data.subtitle}</h5>
					<FormattedDate date={data.publishDate} />
				</div>
			</a>
		))
	}
</section>

<style>
	section a {
		width: 100%;
		border: 1px solid #cccccc;
		display: flex;
		border-radius: 8px;
		text-decoration: none;

		img {
			border-bottom-left-radius: 8px;
			border-top-left-radius: 8px;
		}

		.post-info {
			padding: 1em;
		}
	}
</style>
