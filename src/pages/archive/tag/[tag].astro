---
import { getSortedPosts } from "@utils/content-utils";
import BaseLayout from "@components/layout/BaseLayout.astro";
import PostsTimeline from "../../../components/archive/PostsTimeline.astro";

export async function getStaticPaths() {
	let posts = await getSortedPosts();

	const allTags = posts.reduce((acc, post) => {
		post.data.tags.forEach((tag) => acc.add(tag));
		return acc;
	}, new Set());

	const allTagsArray = Array.from(allTags);

	return allTagsArray.map((tag) => {
		return {
			params: {
				tag: tag,
			},
		};
	});
}

const { tag } = Astro.params;
---

<BaseLayout title={"Archive"}>
	<PostsTimeline tags={[tag]} />
</BaseLayout>
